CREATE DATABASE FlightManager

CREATE TABLE KhachHang
(
	MaKH		CHAR(8) PRIMARY KEY,
	GioiTinh	NVARCHAR(3),
	TenKH		NVARCHAR(30),
	NgaySinh	SMALLDATETIME,
	LoaiKH		NVARCHAR(20),
	SDT			CHAR(10),
	DiaChi		NVARCHAR(50),
	Email		NVARCHAR(20),
	CCCD		NVARCHAR(20)
)

CREATE TABLE NhanVien
(
	MaNV		CHAR(5) PRIMARY KEY,
	TenNV		NVARCHAR(30),
	SDT			CHAR(10),
	DiaChi		NVARCHAR(50),
	ChucVu		NVARCHAR(30),
	CCCD		NVARCHAR(20),
	
)

CREATE TABLE MayBay
(
	MaMB		CHAR(5) PRIMARY KEY,
	TenMB		NVARCHAR(20),
	Hang		NVARCHAR(20),
	KichThuoc	NVARCHAR(10),
	SoCho		INT
)

CREATE TABLE DuongBay
(
	MaDB		CHAR(3) PRIMARY KEY,
	ViTri		NVARCHAR(30),
	ChieuDai	float,
	ChieuRong	float,
	TinhTrang	NVARCHAR(20)
)

CREATE TABLE ChuyenBay
(
	MaCB		CHAR(8) PRIMARY KEY,
	MaMB		CHAR(5) FOREIGN KEY REFERENCES MayBay (MaMB),
	MaDB		CHAR(3) FOREIGN KEY REFERENCES DuongBay (MaDB),
	NoiKH		NVARCHAR(50),
	NoiDen		NVARCHAR(50)
)

CREATE TABLE Ve
(
	MaVe		CHAR(8) PRIMARY KEY,
	MaCB		CHAR(8) FOREIGN KEY REFERENCES ChuyenBay (MaCB),
	TGKhoiHanh	SMALLDATETIME,
	TGDen		SMALLDATETIME,
	Gia			MONEY
)

CREATE TABLE QLVe
(
	MaCB		CHAR(8) FOREIGN KEY REFERENCES ChuyenBay (MaCB),
	Dot			INT,
	SL			INT,
	TinhTrang	NVARCHAR(20),
	constraint PK_QLVe  primary key (MaCB,Dot)
)

CREATE TABLE HoaDon
(
	MaHD		CHAR(8) PRIMARY KEY,
	MaNV		CHAR(5) FOREIGN KEY REFERENCES NhanVien (MaNV),
	MaKH		CHAR(8) FOREIGN KEY REFERENCES KhachHang (MaKH),
	NgHD		SMALLDATETIME,
	TriGia		MONEY
)

CREATE TABLE CTHD
(
	MaHD		CHAR(8) FOREIGN KEY REFERENCES HoaDon (MaHD),
	MaVe		CHAR(8) FOREIGN KEY REFERENCES Ve (MaVe),
	SL		INT,
	TriGia		MONEY,
	CONSTRAINT PK_CTHD PRIMARY KEY (MaHD,MaVe)
)
